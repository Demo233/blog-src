---
title: docker部署hadoop
date: 2020年11月15日11:02:07
categories: 其他
tags: Docker
---

首先我们构建一个jdk1.8+centos基础镜像，由于网上已经有很多现成的轮子，这里就不自己造了

```docker
docker pull ryaning/centos-ssh
```

## 一、构建基础镜像

如果镜像下载不下来，可以使用下面方法自己创建基础镜像

```shell

# 编辑 Dockerfile
vi Dockerfile
``` 

新增以下内容

```shell
# 基础镜像
FROM ryaning/centos-ssh
# 作者
MAINTAINER  Ryan <me@ryana.cn>
# 构建镜像
ADD jdk-8u162-linux-x64.tar.gz /usr/local/
RUN mv /usr/local/jdk1.8.0_162 /usr/local/jdk1.8
ENV JAVA_HOME /usr/local/jdk1.8
ENV PATH $JAVA_HOME/bin:$PATH

ADD hadoop-2.9.2.tar.gz /usr/local
RUN mv /usr/local/hadoop-2.9.2 /usr/local/hadoop
ENV HADOOP_HOME /usr/local/hadoop
ENV PATH $HADOOP_HOME/bin:$PATH

RUN yum install -y which sudo
```

## 二、 搭建hadoop集群

### 规划

准备搭建一个具有三个节点的集群,1 master 2 slave

* master: hadoop0 ip: 192.168.10.10
* salve1: hadoop1 ip: 192.168.10.11
* salve2: hadoop2 ip: 192.168.10.12

### 配置IP

docker 容器在启动时默认使用的是 bridge 模式，docker 容器启动后，会连接到一个名为 docker0 的虚拟网桥，故每次启动 docker 容器的 IP 都不是固定的，不方便管理，有时候需要进行固定 IP 映射，比如 docker 集群管理时。docker 在 1.9 版本版后，提供了创建自定义网络功能命令。

```shell
# 创建自定义网络 

# ip段为：192.168.10.1/24，名字为：hadoop
docker network create --subnet=192.168.10.1/24 hadoop
# 显示自定义网络列表
docker network ls

```


 